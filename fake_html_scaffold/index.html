<html>
  <head>
    <title>Fake Overlay</title>
    <link rel="stylesheet" href="ritoverlay.css">
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha256-k2WSCIexGzOj3Euiig+TlR8gA0EmPjuc79OEeY5L45g=" crossorigin="anonymous"></script>
    <script>
var sorcererShoe = `
    <div class="ritoverlay-title">Sorcerer's shoe</div>
    <div class="ritoverlay-attributes">
      <ul>
        <li>+25 something</li>
        <li>+25 something else</li>
        <li>+15% something</li>
      </ul>
    </div>

    <div class="ritoverlay-text">
      <p>
        <strong>UNIQUE passive:rage:</strong> Basic
      </p>
      <p>
        Tons of damage
      </p>
    </div>`;

var liandryTorment = `
    <div class="ritoverlay-title">Liandry's Torment</div>
    <div class="ritoverlay-attributes">
      <ul>
        <li>+25 something</li>
        <li>+25 something else</li>
        <li>+15% something</li>
      </ul>
    </div>

    <div class="ritoverlay-text">
      <p>
        <strong>UNIQUE passive:rage:</strong> Basic
      </p>
      <p>
        Tons of damage
      </p>
    </div>`;

// New match for Sorcerer's Shoes at (1163, 956)
// New match for Sorcerer's Shoes at (851, 331)
// New match for Sorcerer's Shoes at (1388, 407)
// New match for Sorcerer's Shoes at (1388, 635)
//  Looking for Liandry's Torment
// New match for Liandry's Torment at (716, 332)
// New match for Liandry's Torment at (716, 484)
// New match for Liandry's Torment at (1287, 484)

var data = [
  {
    x: 1163,
    y: 956,
    w: 40,
    h: 40,
    content: sorcererShoe
  },
  {
    x: 851,
    y: 331,
    w: 33,
    h: 33,
    content: sorcererShoe
  },
  {
    x: 1388,
    y: 407,
    w: 33,
    h: 33,
    content: sorcererShoe
  },
  {
    x: 1388,
    y: 635,
    w: 33,
    h: 33,
    content: sorcererShoe
  },
  {
    x: 716,
    y: 332,
    w: 33,
    h: 33,
    content: liandryTorment
  },
  {
    x: 716,
    y: 484,
    w: 33,
    h: 33,
    content: liandryTorment
  },
  {
    x: 1287,
    y: 484,
    w: 33,
    h: 33,
    content: liandryTorment
  },
];

$(function() {
  "use strict";

  var img = document.getElementById('stream');
  var ritoverlay = document.getElementById('ritoverlay');
  var wrapper = document.getElementById('wrapper');
  var hasDisplayedBlock = true;

  img.addEventListener('mousemove', function(e) {
    var originalWidth = img.naturalWidth;
    var originalHeight = img.naturalHeight;
    var currentWidth = img.width;
    var currentHeight = img.height;
    var ratio = currentWidth / originalWidth;

    if(!hasDisplayedBlock) {
      data.forEach(function(d) {
        var div = document.createElement('div');
        div.style.position = 'absolute';
        div.style.width = d.w * ratio;
        div.style.height = d.h * ratio;
        div.style.left = d.x * ratio;
        div.style.top = d.y * ratio;
        div.style.backgroundColor = 'rgba(255, 0, 0, 0.4)';
        wrapper.appendChild(div);
      });
      hasDisplayedBlock = true;
    }

    var mouseX = e.layerX;
    var mouseY = e.layerY;
    console.log(mouseX, mouseY);
    var convertedClientX = mouseX / ratio;
    var convertedClientY = mouseY / ratio;

    var matchingTooltip = data.filter(function(d) {
      return Math.abs(d.x + d.w / 2 - convertedClientX) < d.w * ratio / 2 && Math.abs(d.y + d.h / 2 - convertedClientY) < d.h * ratio / 2;
    });

    if(matchingTooltip.length > 0) {
      ritoverlay.style.display = 'block';
      ritoverlay.style.left = mouseX - 25;
      ritoverlay.style.bottom = img.height - mouseY + 24;
      var tooltip = matchingTooltip[0];
      ritoverlay.innerHTML = tooltip.content;
    }
    else {
      ritoverlay.style.display = 'none';
    }
  });
});
    </script>
  </head>
  <body>
    <div style="position: relative" id="wrapper">
      <div class="ritoverlay" id="ritoverlay" style="display: none; position: absolute;"></div>
      <img src="../screenshots/stream1.png" id="stream" style="width: 100%"/>
    </div>
  </body>
</html>
